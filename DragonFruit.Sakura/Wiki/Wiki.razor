@page "/wiki/"
@page "/wiki/{*path}"

@if (PageContent == null)
{
    <PageTitle>Wiki &middot; DragonFruit Network</PageTitle>
}
else
{
    <PageTitle>@PageContent.Title &middot; DragonFruit Wiki</PageTitle>
}

<HeadContent>
    <meta property="theme-color" content="#9c27b0"/>
    <meta property="og:title" content="@(PageContent?.Title ?? "Wiki") &middot; DragonFruit Network"/>
    <meta name="keywords" content="@string.Join(", ", PageContent?.Tags ?? Enumerable.Empty<string>())"/>

    <link rel="stylesheet" href="/styles/wiki.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jetbrains-mono@1.0.6/css/jetbrains-mono.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.26.0/themes/prism-tomorrow.min.css"/>
</HeadContent>

<GlobalNavigation/>

<MudContainer MaxWidth="MaxWidth.Large" Class="mt-4">
    <MudStack Spacing="4">

        <MudStack Row="true" Class="flex-wrap">
            <MudText Typo="Typo.h5">Wiki</MudText>
            @if (PageContent != null)
            {
                <MudSpacer/>
                <MudBreadcrumbs Items="GenerateBreadcrumbs()" Class="p-0"/>
            }
        </MudStack>

        <MudPaper Elevation="0" Class="px-4 py-3" Style="min-height: 75vh">
            @if (PageContent == null)
            {
                // dummy content
                <MudSkeleton SkeletonType="SkeletonType.Text" Height="50px" Width="250px"/>

                <MudStack Spacing="1" Class="mt-3">
                    @for (var i = 0; i < 15; i++)
                    {
                        <MudSkeleton SkeletonType="SkeletonType.Text" Height="30px" Width="100%"/>
                    }
                </MudStack>
            }
            else
            {
                // main content
                <MudStack Style="min-height: inherit">
                    @if (PageContent?.Stub == true)
                    {
                        <MudAlert Severity="Severity.Warning" Icon="@Icons.Rounded.PieChart">
                            This article is a stub and is waiting for expansion.
                        </MudAlert>
                    }
                    else if (PageContent?.Outdated == true)
                    {
                        <MudAlert Severity="Severity.Info" Icon="@Icons.Rounded.History">
                            This article is outdated and needs reviewing to ensure the content is up-to-date.
                        </MudAlert>
                    }

                    <div id="wiki-content">
                        @PageContent.Content
                    </div>

                    @if (PageMetadata != null)
                    {
                        <MudSpacer/>
                        <MudDivider/>

                        <MudStack Row="true" AlignItems="AlignItems.Center">
                            <MudText Typo="Typo.caption">Last updated @PageMetadata.LastUpdated.ToString("D")</MudText>
                            <MudSpacer/>
                            <MudAvatarGroup Max="5" Spacing="2">
                                @foreach (var author in PageMetadata.Authors)
                                {
                                    <MudAvatar Image="@author.AvatarUrl" Size="Size.Small">@author.Username[0]</MudAvatar>
                                }
                            </MudAvatarGroup>
                            @* <MudButton Color="Color.Transparent" StartIcon="@Icons.Custom.Brands.GitHub" Href="">View on GitHub</MudButton> *@
                        </MudStack>
                    }
                </MudStack>
            }
        </MudPaper>
    </MudStack>
</MudContainer>
<SakuraFooter/>